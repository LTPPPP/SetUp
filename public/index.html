<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bàn phỏng vấn</title>
    <link rel="stylesheet" href="./assets/style.css">
</head>

<body>
    <h1>Bàn phỏng vấn</h1>
    <div id="tables">
        <div class="table-container">
            <div class="table-title">Bàn 1</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification0"></div>
                    <button class="button green" id="button0">Bảo Nguyên</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification1"></div>
                    <button class="button green" id="button1">Phan<br>Thuận</button>
                </div>
            </div>
        </div>
        <div class="table-container">
            <div class="table-title">Bàn 2</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification2"></div>
                    <button class="button green" id="button2">Minh<br>Tiến</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification3"></div>
                    <button class="button green" id="button3">Hoàng<br>Đạt</button>
                </div>
            </div>
        </div>
        <div class="table-container">
            <div class="table-title">Bàn 3</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification4"></div>
                    <button class="button green" id="button4">Đại<br>Nhân</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification5"></div>
                    <button class="button green" id="button5">Minh<br>Phúc</button>
                </div>
            </div>
        </div>
        <div class="table-container">
            <div class="table-title">Bàn 4</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification6"></div>
                    <button class="button green" id="button6">Lê<br>Thịnh</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification7"></div>
                    <button class="button green" id="button7">Tấn<br>Cường</button>
                </div>
            </div>
        </div>
    </div>
    <audio id="notificationSound" src="./assets/sound/alarm.wav"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const notificationSound = document.getElementById('notificationSound');

        // Array of button elements
        const buttons = Array.from({ length: 8 }, (_, i) => document.getElementById(`button${i}`));

        // Array of notification elements
        const notifications = Array.from({ length: 8 }, (_, i) => document.getElementById(`notification${i}`));

        // Handle click event for each button
        buttons.forEach((button, index) => {
            button.addEventListener('click', () => {
                socket.emit('button-click', index);
            });
        });

        // Update the button states when receiving data from the server
        socket.on('update-buttons', (buttonStates, names, mssvs) => {
            buttonStates.forEach((state, index) => {
                if (state) {
                    buttons[index].className = 'button red';
                    notifications[index].textContent = `${names[index] || ''} - ${mssvs[index] || ''}`;
                    if (buttons[index].className !== 'button red') {
                        notificationSound.play();
                    }
                } else {
                    buttons[index].className = names[index] ? 'button blue' : 'button green';
                    notifications[index].textContent = names[index] ? `${names[index]} - ${mssvs[index]}` : 'Đã trống';
                }
            });
        });
    </script>
</body>

</html>
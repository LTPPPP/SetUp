<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bàn phỏng vấn</title>
    <link rel="stylesheet" href="./assets/style.css">
</head>

<body>
    <h1>Bàn phỏng vấn</h1>
    <div id="tables">
        <div class="table-container">
            <div class="table-title">Bàn 1</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification0"></div>
                    <button class="button" id="button0">A</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification1"></div>
                    <button class="button" id="button1">B</button>
                </div>
            </div>
        </div>
        <div class="table-container">
            <div class="table-title">Bàn 2</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification2"></div>
                    <button class="button" id="button2">A</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification3"></div>
                    <button class="button" id="button3">B</button>
                </div>
            </div>
        </div>
        <div class="table-container">
            <div class="table-title">Bàn 3</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification4"></div>
                    <button class="button" id="button4">A</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification5"></div>
                    <button class="button" id="button5">B</button>
                </div>
            </div>
        </div>
        <div class="table-container">
            <div class="table-title">Bàn 4</div>
            <div class="button-group">
                <div class="button-container">
                    <div class="notification" id="notification6"></div>
                    <button class="button" id="button6">A</button>
                </div>
                <div class="button-container">
                    <div class="notification" id="notification7"></div>
                    <button class="button" id="button7">B</button>
                </div>
            </div>
        </div>
    </div>

    <audio id="notificationSound" src="./assets/sound/alarm.wav"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const notificationSound = document.getElementById('notificationSound');

        // Array of button elements
        const buttons = Array.from({ length: 8 }, (_, i) => document.getElementById(`button${i}`));

        // Array of notification elements
        const notifications = Array.from({ length: 8 }, (_, i) => document.getElementById(`notification${i}`));

        // Handle click event for each button
        buttons.forEach((button, index) => {
            button.addEventListener('click', () => {
                socket.emit('button-click', index);
            });
        });

        // Update the button states when receiving data from the server
        socket.on('update-buttons', (buttonStates, names) => {
            buttonStates.forEach((state, index) => {
                const newClass = state ? 'button red' : 'button green';
                if (buttons[index].className === 'button red' && newClass === 'button green') {
                    notificationSound.play();
                    notifications[index].textContent = names[0] || 'Đã trống';
                } else if (newClass === 'button red') {
                    notifications[index].textContent = '';
                }
                buttons[index].className = newClass;
            });
        });
    </script>
</body>

</html>